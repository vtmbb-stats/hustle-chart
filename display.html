<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VT Men's Basketball Hustle Display</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        
        .dark-mode {
            background-color: #111827 !important;
        }
        
        .light-mode {
            background-color: #f9fafb !important;
        }

        .table-header {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body class="light-mode">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useCallback, useEffect, useRef } = React;

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDabJZx_x3SJEYk1dWwHJw0wUsp48yUWxc",
            authDomain: "vtmbb-hustle-chart.firebaseapp.com",
            projectId: "vtmbb-hustle-chart",
            storageBucket: "vtmbb-hustle-chart.firebasestorage.app",
            messagingSenderId: "210232739134",
            appId: "1:210232739134:web:78ed344affb9f8c0ba586f"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const HustleDisplay = () => {
            const [darkMode, setDarkMode] = useState(false);
            const [mainTableData, setMainTableData] = useState(null);
            const [sortColumn, setSortColumn] = useState('Total');
            const [mainTablePeriod, setMainTablePeriod] = useState('recent'); // recent, last5, season
            const [trendingData, setTrendingData] = useState({ up: [], down: [] });
            const [selectedPlayer, setSelectedPlayer] = useState('');
            const [selectedPeriod, setSelectedPeriod] = useState('last5'); // last5, last10, season
            const [chartData, setChartData] = useState(null);
            const [loading, setLoading] = useState(true);
            const [lastUpdated, setLastUpdated] = useState(null);
            const [loadingData, setLoadingData] = useState(false);
            const [allPracticesData, setAllPracticesData] = useState([]);
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            // All stats and their point values for Total calculation
            const statWeights = {
                // Positive stats
                'Offensive Rebound': 1,
                'Assist': 1,
                'Extra Pass': 1,
                'Screen Assist': 1,
                'Hokie Assist': 1,
                'Steal': 1,
                'Deflection': 1,
                'Charge Drawn': 5,
                'Hustle Play': 1,
                'Coach\'s Point': 1,
                // Negative stats
                'Turnover': -1,
                'Foul': -1,
                'No Crash-Get Back': -1,
                'Missed Close Out': -1,
                'Missed Box Out': -1,
                'Body Language': -1
            };

            const allStats = Object.keys(statWeights);

            // Define the order for display (Total first, then all other stats)
            const displayOrder = ['Total', ...allStats];

            // Player roster
            const players = [
                { number: 0, lastName: "Bedford", firstName: "Jailen" },
                { number: 1, lastName: "Lawal", firstName: "Tobi" },
                { number: 2, lastName: "Schutt", firstName: "Jaden" },
                { number: 3, lastName: "Hammond", firstName: "Ben" },
                { number: 4, lastName: "Pasha", firstName: "Izaiah" },
                { number: 5, lastName: "Jones", firstName: "Sin'Cere" },
                { number: 7, lastName: "Freeman", firstName: "Brett" },
                { number: 10, lastName: "Johnson", firstName: "Tyler" },
                { number: 13, lastName: "Hansberry", firstName: "Amani" },
                { number: 15, lastName: "Peterkin", firstName: "Snook" },
                { number: 17, lastName: "Avdalas", firstName: "Neo" },
                { number: 22, lastName: "Davis", firstName: "Solomon" },
                { number: 32, lastName: "Gurdak", firstName: "Christian" },
                { number: 77, lastName: "Dorn", firstName: "Antonio" }
            ];

            // Update body class when dark mode changes
            useEffect(() => {
                document.body.className = darkMode ? 'dark-mode' : 'light-mode';
            }, [darkMode]);

            // Calculate total score for a
